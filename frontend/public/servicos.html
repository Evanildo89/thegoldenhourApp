<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Serviços</title>
  <link rel="stylesheet" href="./servicos.css">
</head>
<body>
  <div class="servicos-page" style="background-color: #eee; min-height: 100vh;">
    <!-- Topo -->
    <div class="servicos-topo">
      <a href="/" class="back-button">&lt;</a>
      <div class="logo-circle-servicos">
        <img src="./images/3.png" alt="Logo" />
      </div>
      <div class="empresa-name-servicos">The Golden Light Photography</div>
    </div>

    <p class="services-subtitle-top">Serviços</p>

    <div id="services-container"></div>

    <script>
      const API_BASE_URL = "http://localhost:8000";
  // Função para pegar parâmetros da URL
function getQueryParams(param) {
    const params = new URLSearchParams(window.location.search);
    const value = params.get(param);
    return value ? JSON.parse(decodeURIComponent(value)) : null;
}

// Obter serviços e profissional
const services = getQueryParams('data') || [];
const professional = getQueryParams('prof') || {};

const container = document.getElementById('services-container');

services.forEach(service => {
    const box = document.createElement('div');
    box.className = 'servicos-box';

    // Criar conteúdo do serviço
    box.innerHTML = `
      <div class="servicos-content">
        <h3 class="services-title">${service.title}</h3>
        <div class="servicos-description">
          <ul>
            <li>Tempo de sessão: ${service.duration_minutes} minutos</li>
            ${service.description.split('\n').map(line => `<li>${line}</li>`).join('')}
            <li>Valor base: ${service.price}€</li>
          </ul>
        </div>
      </div>
    `;

    // Criar seta
    const arrow = document.createElement('div');
    arrow.className = 'servicos-arrow';
    arrow.innerHTML = '&gt;';

    // Adicionar evento de clique
    arrow.addEventListener('click', () => {
        const profData = professional ? encodeURIComponent(JSON.stringify(professional)) : '';
        const prof_id = professional.id || ''; // garante que sempre exista
        console.log("Profissional atual:", professional);

        const url = `calendario.html?service_id=${service.id}` +
                    `&title=${encodeURIComponent(service.title)}` +
                    `&price=${service.price}` +
                    `&duration=${service.duration_minutes}` +
                    `&prof=${profData}` +
                    `&prof_id=${prof_id}`;

        window.location.href = url;
    });

    box.appendChild(arrow);
    container.appendChild(box);
});
</script>
  </div>
</body>
</html>